# Android Kotlin을 통한 개발 전략

Naver techcon android : SESSION5 
강사 : 신동길

코틀린은 다른 언어들의 속성을 많이 가지고 있다. 그 중 가장 비슷한 것이 스칼라라는 말도 있지만 C#이라는 의견도 있다. 코틀린은 C#의 거의 모든 특성을 가지고있으면 단지 기능들을 좀 더 간결하게 사용한다는 차이밖에 없다. 아래는 여러 언어의 장점에서 빼온 코틀린의 특징이다. 

+ Operator Overloading : ~~아래에서 예로 설명~~
+ Property : 프로퍼티는 이해시키려고해도 어려운 것이다. 우선 필드에 접근을 하면 프로퍼티이고 접근을 하지 않으면 함수가 된다. 또, getter( ), setter( )를 사용하지 않으면 변수이다. 프로퍼티를 사용하기 가장 효율적인 상황은 어떠한 값을 저장해놓고 그걸 전달하는 경우이다. 
+ 데이터 스트림 모델 : 이건 스트림에만 사용해야하기 때문에 비교적 명확하다.
+ 람다 : 람다와 함수의 차이는 리턴을 마음대로 할 수 있느냐 그렇지 않느냐이다. 람다는 표현**식**이기 때문에 형식이 없는 반면 함수는 어딘가에서는 리턴을 한다. 이 둘을 어떨 때 사용하나를 구분하기 가장 편리한 근거는 얼마나 길게 쓰이냐이다. 간결하고 반환이 단순한 Unit 형태인 경우에는 람다를 사용해도 괜찮지만 소스의 길이와 깊이가 깊어지면 분명 중간에서는 특정값을 리턴해야하기 때문에 함수를 사용하는 것이 좋다. 하지만 정 함수이름을 정하기 싫으면 **익명함수를 활용하는 것도 좋은 방법이다.**

등 많은 특징들은 이미 존재했던 언어에서 가져온 것이다. 그래서 지금의 코틀린을 보면 거의 모든 장점을 가지고있음에도 막상 소스를 짜다보면 자바 스타일이 나온다는 것이 문제이다. 

## 어떻게하면 자바 스타일을 탈피할 수 있을까?

코틀린의 멤버 변수 초기화 방법에는 4가지가 있다. 그리고 각각의 방법이 어울리는 상황역시도 따로있다.

```kotlin
private var textView: TextView? = null
```

이 방법은 우리가 가장 익숙할 수도있다. 왜냐하면 자바에서 변수를 선언하는 방법과 같기 때문이다. 하지만 단점이라고하면 사용할때마다 null-check를 해줘야하기 때문에 귀찮음을 감수해야한다. ~~(제일 무식한 법)~~

```kotlin
private lateinit var textView: TextView
```

사실 자바 코드를 변환할때는 이게 정석이라고 할 수 있다. 제대로 짰다면 문제가 없다.

```kotlin
private val textView: TextView by lazy { ... }
```

어느시점에 정확하게 호출되는지는 모르지만 불려지는 순간 호출되는 시점에 할당하게 하는 방법도 나쁘진 않다. 

```kotlin
private var textView: TextVew
init {
		textView = ...  
}
```

constructor과 같이 호출되는 init에서 할당해줄 수 있다. 이 방법이 가장 잘 어울릴 때는 View 단위에서 하는 것이다. 그래서 각각의 좋은 방법이 따로있는거고 그런 면에서 코틀린은 개발자가 계속 머리를 쓰게 해줘서 좋은 것 같다..

Nuallable에 대한 처리와 클래스 중첩을 최적화하는 것도 좋은 방법이다. 단, 이때 !!에서 NullPointerExcpetion이 가장 많이 일어나기 때문에 이 부분은 조심해야한다. 이너 클래스의 최소화와 전역변수로 사용 할 수 있으면 빼내는 것이 좋다. 또, 코틀린스럽게 하기 위해서는 Scope Function의 활용도 좋은 방법이 될 수 있는데 let과 apply를 위주로 사용하며 너무 과용할 경우 오히려 가독성이 떨어지는 등의 부작용이 있을 수 있다. 

이렇게 자바스타일을 조금이나마 탈피했더라도 코드가  간결해지고 효율적인건 다른 문제이다.

## 간결하게 하기 위한 요소들

### 전역변수 함수들

클래스와 관계없이 변수나 상수를 정의할 수 있다. 또 아랫 코드 레벨에서 공유되는 변수는 전역으로 상용해도 좋다. 예로는 다음과 같다

+ Global Context : ApplicationContext, Handler, ThreadPool(리소스 관련된 접근들), Resource
+ Systems Managers : Connection Manager, Activity Manger, Window Manager, Wifi Manager
+ System Util Functions : UI와 관련된 것들, Screen Info, dp2Px, package Info 

등등 한 번 정해지면 바뀌지 않는 것들을 전역변수 또는 함수로 두면 좋다. 

### 연산자

연산자를 통해 함수 호출 코드를 간결화 할 수 있고 기존 객체에 연산자를 추가 정의할 수 있다. 연산자 오버로딩을 특히 많이 사용하는데 어떤 클래스 안에 plus라는 이름의 특별한 메소드를 정의하면 해당 인스턴스에 대해 +연산자를 사용 할 수 있게하는 기법을 말한다. 

http://tech.javacafe.io/2018/11/27/%EC%BD%94%ED%8B%80%EB%A6%B0%EC%8A%A4%ED%84%B0%EB%94%94_7%EC%9E%A5_%EC%A0%95%EB%A6%AC/

~~예제를 보는게 더 이해가 빨랐음~~

### Global 함수의 정의와 고차함수 정의(DSL 스타일)

### Global 함수

+ 안드로이드에서 제공하는 기능 중 반복적으로 사용되는 함수를 정의
+ 서비스 코드 내에서 빈번하게 사용하는 코드 정리
+ 이 함수의 정의 목적은 짧은 코드임

### 고차 함수

+ 고차 함수(High Order Function)이란 매개 변수 또는 반환 값으로 람다가 사용되는 함수를 말한다. 자바에서 콜백함수가 이와 비슷하다고 할 수 있다. 

하지만 여기에는 너무 다양한 스타일이 존재하며 개발자에 따라 많이 차이가 나므로 스타일을 어느정도 정해야 할 필요가 있다. 또한 남발하게 되면 gradle처럼 될 수도 있으므로 과용하지 않도록한다.

